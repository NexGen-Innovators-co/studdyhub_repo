[
  {
    "schema": "public",
    "table_name": "achievements",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can insert own achievements",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "achievements",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can view own achievements",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "achievements",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "achievements_select_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_activity_logs",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Admins can view activity logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "is_admin(auth.uid())",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_activity_logs",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "admin_activity_logs_select_admin",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "is_admin()",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_activity_logs",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_admin_activity_logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_activity_logs",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_insert_admin_activity_logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "admin_activity_logs",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_admin_activity_logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_activity_logs",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_update_admin_activity_logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "admin_system_settings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Admins can manage system settings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "ALL",
    "using_expression": "is_admin(auth.uid(), 'admin'::admin_role)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_system_settings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Public settings are readable by all",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(is_public = true)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_system_settings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_admin_system_settings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_system_settings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_insert_admin_system_settings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "admin_system_settings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_admin_system_settings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_system_settings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_update_admin_system_settings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "admin_users",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Super admins can manage admin users",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "ALL",
    "using_expression": "is_admin(auth.uid(), 'super_admin'::admin_role)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "admin_users",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "admin_users_select_admin",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((auth.uid() = user_id) OR is_admin())",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Admins can manage all podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "ALL",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users\n  WHERE (admin_users.user_id = auth.uid())))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Anyone can view public podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{anon}",
    "operation": "SELECT",
    "using_expression": "(is_public = true)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Delete access on ai_podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Insert access on ai_podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Update access on ai_podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can update own podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can view accessible podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((auth.uid() = user_id) OR (is_public = true))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_podcasts_delete_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_podcasts_insert_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_podcasts_select_own_or_public",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((auth.uid() = user_id) OR (is_public = true))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_podcasts_update_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_ai_podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = auth.uid()) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_podcasts",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_ai_podcasts",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = auth.uid()) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_user_memory",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_user_memory_delete_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(( SELECT auth.uid() AS uid) = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_user_memory",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_user_memory_insert_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(( SELECT auth.uid() AS uid) = user_id)"
  },
  {
    "schema": "public",
    "table_name": "ai_user_memory",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_user_memory_select_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(( SELECT auth.uid() AS uid) = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "ai_user_memory",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "ai_user_memory_update_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(( SELECT auth.uid() AS uid) = user_id)",
    "with_check_expression": "(( SELECT auth.uid() AS uid) = user_id)"
  },
  {
    "schema": "public",
    "table_name": "app_stats",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Allow authenticated update of stats row",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(id = '00000000-0000-0000-0000-000000000001'::uuid)",
    "with_check_expression": "(id = '00000000-0000-0000-0000-000000000001'::uuid)"
  },
  {
    "schema": "public",
    "table_name": "app_stats",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Allow public insert of default stats row",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(id = '00000000-0000-0000-0000-000000000001'::uuid)"
  },
  {
    "schema": "public",
    "table_name": "app_stats",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Allow public read access to app_stats",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "true",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "app_stats",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_app_stats",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "app_stats",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_insert_app_stats",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "app_stats",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_app_stats",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "app_stats",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_update_app_stats",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Allow authenticated users to insert their own audio processing ",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Allow authenticated users to read their own audio processing re",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Allow authenticated users to update their own audio processing ",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can delete their own audio processing results",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_audio_processing_results",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_insert_audio_processing_results",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_audio_processing_results",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "audio_processing_results",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_update_audio_processing_results",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "audio_segments",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Insert/Update for podcast hosts on audio_segments",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "ALL",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM ai_podcasts p\n  WHERE ((p.id = audio_segments.podcast_id) AND (p.user_id = auth.uid()))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM ai_podcasts p\n  WHERE ((p.id = audio_segments.podcast_id) AND (p.user_id = auth.uid()))))"
  },
  {
    "schema": "public",
    "table_name": "audio_segments",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Read access for audio segments",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((EXISTS ( SELECT 1\n   FROM ai_podcasts p\n  WHERE ((p.id = audio_segments.podcast_id) AND ((p.is_public = true) OR ((auth.uid() IS NOT NULL) AND (p.user_id = auth.uid())))))) OR ((auth.uid() IS NOT NULL) AND (EXISTS ( SELECT 1\n   FROM podcast_members pm\n  WHERE ((pm.podcast_id = pm.podcast_id) AND (pm.user_id = auth.uid()))))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "badges",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Anyone can view badges",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "true",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "badges",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Authenticated users can view badges",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.role() = 'authenticated'::text)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "badges",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Service role can delete badges",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.role() = 'service_role'::text)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "badges",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Service role can insert badges",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.role() = 'service_role'::text)"
  },
  {
    "schema": "public",
    "table_name": "badges",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Service role can update badges",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.role() = 'service_role'::text)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "calendar_integrations",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can delete own integrations",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "calendar_integrations",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can insert own integrations",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "calendar_integrations",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can update own integrations",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "calendar_integrations",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can view own integrations",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Enable insert for users",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Enable update for users",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can delete own messages",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can view own messages",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "chat_messages_delete_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "chat_messages_insert_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "chat_messages_select_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_chat_messages",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_insert_chat_messages",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_chat_messages",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_messages",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_update_chat_messages",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can create their own chat sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can delete their own chat sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can update their own chat sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can view their own chat sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "chat_sessions_delete_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "chat_sessions_insert_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "chat_sessions_select_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "chat_sessions_update_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_chat_sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_insert_chat_sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_chat_sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "chat_sessions",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_update_chat_sessions",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Allow read for owners and shared recordings via chat",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((user_id = auth.uid()) OR (EXISTS ( SELECT 1\n   FROM ((social_chat_message_resources r\n     JOIN social_chat_messages m ON ((m.id = r.message_id)))\n     JOIN social_chat_sessions s ON ((s.id = m.session_id)))\n  WHERE ((r.resource_id = class_recordings.id) AND ((r.resource_type)::text = 'class_recording'::text) AND ((((s.chat_type)::text = 'p2p'::text) AND ((s.user_id1 = auth.uid()) OR (s.user_id2 = auth.uid()))) OR (((s.chat_type)::text = 'group'::text) AND (EXISTS ( SELECT 1\n           FROM social_group_members gm\n          WHERE ((gm.group_id = s.group_id) AND (gm.user_id = auth.uid()) AND (gm.status = 'active'::text))))))))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can create own recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can delete own recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can update own recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can view own recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "class_recordings_delete_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "class_recordings_insert_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "class_recordings_select_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "class_recordings_update_own",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": "(auth.uid() = user_id)"
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_delete_class_recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_insert_class_recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_select_class_recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "class_recordings",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "super_admin_update_class_recordings",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))",
    "with_check_expression": "(EXISTS ( SELECT 1\n   FROM admin_users au\n  WHERE ((au.user_id = ( SELECT auth.uid() AS uid)) AND (au.role = 'super_admin'::admin_role))))"
  },
  {
    "schema": "public",
    "table_name": "content_moderation_log",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Admins can view all moderation logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM admin_users\n  WHERE ((admin_users.user_id = auth.uid()) AND ((admin_users.role = 'super_admin'::admin_role) OR (admin_users.role = 'admin'::admin_role) OR (admin_users.role = 'moderator'::admin_role)))))",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "content_moderation_log",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Block client inserts on moderation logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check_expression": "false"
  },
  {
    "schema": "public",
    "table_name": "content_moderation_log",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Users can view their own moderation logs",
    "is_permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(auth.uid() = user_id)",
    "with_check_expression": null
  },
  {
    "schema": "public",
    "table_name": "content_moderation_queue",
    "rls_enabled": true,
    "rls_forced": false,
    "policy_name": "Admins can manage moderation queue",
    "is_permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "ALL",
    "using_expression": "is_admin(auth.uid())",
    "with_check_expression": null
  },
  {
    "policyname": "Allow all operations for authenticated users",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "ALL",
    "using_expression": "(bucket_id = 'social-media'::text)",
    "with_check": "(bucket_id = 'social-media'::text)"
  },
  {
    "policyname": "Allow authenticated deletes from documents bucket",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "((bucket_id = 'documents'::text) AND (auth.uid() IS NOT NULL))",
    "with_check": null
  },
  {
    "policyname": "Allow authenticated updates to documents bucket",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "((bucket_id = 'documents'::text) AND (auth.uid() IS NOT NULL))",
    "with_check": "((bucket_id = 'documents'::text) AND (auth.uid() IS NOT NULL))"
  },
  {
    "policyname": "Allow authenticated uploads to documents bucket",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "((bucket_id = 'documents'::text) AND (auth.uid() IS NOT NULL))"
  },
  {
    "policyname": "Allow authenticated uploads to podcasts",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "((bucket_id = 'podcasts'::text) AND (auth.role() = 'authenticated'::text))"
  },
  {
    "policyname": "Allow delete on podcasts for owners",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "((bucket_id = 'podcasts'::text) AND (owner = auth.uid()))",
    "with_check": null
  },
  {
    "policyname": "Allow public reads from documents bucket",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(bucket_id = 'documents'::text)",
    "with_check": null
  },
  {
    "policyname": "Allow read on shared document files",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((bucket_id = 'documents'::text) AND ((auth.uid() = owner) OR (EXISTS ( SELECT 1\n   FROM (((documents d\n     JOIN social_chat_message_resources r ON (((r.resource_id = d.id) AND ((r.resource_type)::text = 'document'::text))))\n     JOIN social_chat_messages m ON ((m.id = r.message_id)))\n     JOIN social_chat_sessions s ON ((s.id = m.session_id)))\n  WHERE ((objects.name ~~ (d.id || '%'::text)) OR ((objects.name ~~ (('%'::text || d.id) || '%'::text)) AND ((((s.chat_type)::text = 'p2p'::text) AND ((s.user_id1 = auth.uid()) OR (s.user_id2 = auth.uid()))) OR (((s.chat_type)::text = 'group'::text) AND (EXISTS ( SELECT 1\n           FROM social_group_members gm\n          WHERE ((gm.group_id = s.group_id) AND (gm.user_id = auth.uid()) AND (gm.status = 'active'::text))))))))))))",
    "with_check": null
  },
  {
    "policyname": "Allow select on podcasts for owners and public",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((bucket_id = 'podcasts'::text) AND ((owner = auth.uid()) OR ((metadata ->> 'public'::text) = 'true'::text)))",
    "with_check": null
  },
  {
    "policyname": "Allow update on podcasts for owners",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "((bucket_id = 'podcasts'::text) AND (owner = auth.uid()))",
    "with_check": "((bucket_id = 'podcasts'::text) AND (owner = auth.uid()))"
  },
  {
    "policyname": "Anyone authenticated can view social media files",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "((bucket_id = 'social-media'::text) AND (auth.role() = 'authenticated'::text))",
    "with_check": null
  },
  {
    "policyname": "Authenticated users can upload",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "((bucket_id = 'social-media'::text) AND (auth.role() = 'authenticated'::text))"
  },
  {
    "policyname": "Authenticated users can upload chat documents",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "((bucket_id = 'chat-documents'::text) AND ((storage.foldername(name))[1] = (( SELECT auth.uid() AS uid))::text))"
  },
  {
    "policyname": "Public can view podcast audio",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "SELECT",
    "using_expression": "(bucket_id = 'podcasts'::text)",
    "with_check": null
  },
  {
    "policyname": "Users can delete own social media",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "((bucket_id = 'social-media'::text) AND (auth.uid() = owner))",
    "with_check": null
  },
  {
    "policyname": "Users can delete their own chat documents",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "((bucket_id = 'chat-documents'::text) AND ((storage.foldername(name))[1] = (( SELECT auth.uid() AS uid))::text))",
    "with_check": null
  },
  {
    "policyname": "Users can delete their own documents",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "DELETE",
    "using_expression": "((bucket_id = 'documents'::text) AND ((auth.uid())::text = (storage.foldername(name))[1]))",
    "with_check": null
  },
  {
    "policyname": "Users can delete their own podcast audio",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "DELETE",
    "using_expression": "((bucket_id = 'podcasts'::text) AND ((storage.foldername(name))[1] = 'live-podcasts'::text))",
    "with_check": null
  },
  {
    "policyname": "Users can update their own chat documents",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "((bucket_id = 'chat-documents'::text) AND ((storage.foldername(name))[1] = (( SELECT auth.uid() AS uid))::text))",
    "with_check": null
  },
  {
    "policyname": "Users can update their own documents",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "UPDATE",
    "using_expression": "((bucket_id = 'documents'::text) AND ((auth.uid())::text = (storage.foldername(name))[1]))",
    "with_check": null
  },
  {
    "policyname": "Users can update their own podcast audio",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "UPDATE",
    "using_expression": "(bucket_id = 'podcasts'::text)",
    "with_check": "(bucket_id = 'podcasts'::text)"
  },
  {
    "policyname": "Users can upload their own documents",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "((bucket_id = 'documents'::text) AND ((auth.uid())::text = (storage.foldername(name))[1]))"
  },
  {
    "policyname": "Users can upload their own podcast audio",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "((bucket_id = 'podcasts'::text) AND ((storage.foldername(name))[1] = 'live-podcasts'::text))"
  },
  {
    "policyname": "Users can upload to social-media",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "((bucket_id = 'social-media'::text) AND (auth.uid() = owner))"
  },
  {
    "policyname": "Users can view their own chat documents",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "((bucket_id = 'chat-documents'::text) AND ((storage.foldername(name))[1] = (( SELECT auth.uid() AS uid))::text))",
    "with_check": null
  },
  {
    "policyname": "access to user avatar 1oj01fe_0",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "SELECT",
    "using_expression": "(bucket_id = 'avatars'::text)",
    "with_check": null
  },
  {
    "policyname": "access to user avatar 1oj01fe_1",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "operation": "INSERT",
    "using_expression": null,
    "with_check": "(bucket_id = 'avatars'::text)"
  }
]